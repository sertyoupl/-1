<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>Welcome to HTML Editor Free</h1>
    <p>Start editing your HTML, CSS, and JavaScript here!</p>
</body>
</html><!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>ëŒ€ê¸°ì—´ ë“±ë¡</title>
</head>
<body>

<h2>í•™ë²ˆ & ì´ë¦„ ì…ë ¥</h2>
<input id="hakbun" placeholder="í•™ë²ˆ ì…ë ¥" />
<input id="name" placeholder="ì´ë¦„ ì…ë ¥" />
<button id="submitBtn">ëŒ€ê¸°ì—´ ë“±ë¡</button>

<div id="result"></div>
<div id="callMessage" style="margin-top:20px; font-size:20px; color:red;"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";

// ğŸ”¥ Firebase Config
const firebaseConfig = {
  apiKey: "AIzaSyCg4-kN-f9Rwh0C11unaMZLZc6QIa4VoPo",
  authDomain: "project-2267116559464065713.firebaseapp.com",
  databaseURL: "https://project-2267116559464065713-default-rtdb.firebaseio.com",
  projectId: "project-2267116559464065713",
  storageBucket: "project-2267116559464065713.firebasestorage.app",
  messagingSenderId: "599441103724",
  appId: "1:599441103724:web:41a0ac163abe4882e37149"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// ë“±ë¡ ë²„íŠ¼
document.getElementById("submitBtn").onclick = function() {
  const hakbun = document.getElementById("hakbun").value.trim();
  const name = document.getElementById("name").value.trim();
  if(!hakbun||!name){ alert("í•™ë²ˆê³¼ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”."); return; }

  push(ref(db,"queue"),{
    hakbun: hakbun,
    name: name,
    time: Date.now()
  });

  document.getElementById("result").innerText = `${name} í•™ìƒ ë“±ë¡ ì™„ë£Œ!`;
  document.getElementById("hakbun").value="";
  document.getElementById("name").value="";
};

// ìˆ«ìë¥¼ ìë¦¬ë³„ë¡œ ì½ëŠ” í•¨ìˆ˜ (ìŒì„±ìš©)
function speakDigits(numberString){
  return numberString.split('').join(' '); // "3333" -> "3 3 3 3"
}

// ìŒì„± ì•ˆë‚´
function speak(text){
  const msg = new SpeechSynthesisUtterance(text);
  msg.lang = "ko-KR";
  window.speechSynthesis.speak(msg);
}

// PC í˜¸ì¶œ ê°ì§€ ë° í•œ ë²ˆë§Œ ì¬ìƒ
let lastCallId = null;  // ë§ˆì§€ë§‰ í˜¸ì¶œ ê¸°ë¡

const currentCallRef = ref(db,"currentCall");
onValue(currentCallRef,snapshot=>{
  const data = snapshot.val();
  if(data && data.time !== lastCallId){
    lastCallId = data.time;  // í•œ ë²ˆë§Œ ì¬ìƒ

    // ê¸€ë¡œ í‘œì‹œ: ìˆ«ì ê·¸ëŒ€ë¡œ
    const callText = `${data.hakbun} ${data.name} í•™ìƒ, ì…ì¥í•˜ì„¸ìš”!`;
    document.getElementById("callMessage").innerText = `ğŸ“¢ í˜¸ì¶œ: ${callText}`;

    // ìŒì„±: ê° ìë¦¬ ìˆ«ìë³„ë¡œ ì½ê¸° + ì´ë¦„
    const spokenText = `${speakDigits(data.hakbun)} ${data.name} í•™ìƒ, ì…ì¥í•˜ì„¸ìš”!`;
    speak(spokenText);
  }
});
</script>

</body>
</html>
